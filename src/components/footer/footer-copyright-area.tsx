import { SocialMediaLinks } from '@/components/footer/social-media-links';
import { CeviSchweiz } from '@/components/svg-logos/cevi-schweiz';
import { LinkComponent } from '@/components/ui/link-component';
import type { StaticTranslationString } from '@/types/types';
import { getBuildInfo } from '@/utils/get-build-info';
import { getLocaleFromCookies } from '@/utils/get-locale-from-cookies';
import { renderInAppDesign } from '@/utils/render-in-app-design';
import { cn } from '@/utils/tailwindcss-override';
import config from '@payload-config';
import { getPayload } from 'payload';
import React, { Fragment } from 'react';

interface Arguments {
  children: React.ReactNode;
}

const FooterMinimalMenu: React.FC = async () => {
  const payload = await getPayload({ config });
  const locale = await getLocaleFromCookies();

  const { minimalFooterMenu } = await payload.findGlobal({ slug: 'footer', locale });
  if (minimalFooterMenu === undefined || minimalFooterMenu === null) return <></>;

  if (minimalFooterMenu.length === 0) return <></>;

  return (
    <div className="mb-2 flex justify-center gap-x-4 text-xs">
      {minimalFooterMenu.map((footerMenuElement) => (
        <Fragment key={footerMenuElement.id}>
          <LinkComponent href={footerMenuElement.link ?? ''}>
            {footerMenuElement.label}
          </LinkComponent>
        </Fragment>
      ))}
    </div>
  );
};

const FooterCopyrightText: React.FC<Arguments> = ({ children }) => {
  return (
    <span className="font-heading mt-[32px] text-[22px] leading-[24x] font-bold">{children}</span>
  );
};

const footerCopyrightText: StaticTranslationString = {
  de: 'vom',
  fr: 'de',
  en: 'from',
};

export const FooterBuildInfoText: React.FC<Arguments> = ({ children }: Arguments) => {
  return <span className="text-[12px] leading-[16px] font-light">{children}</span>;
};

const FooterGraphic: React.FC = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    xmlSpace="preserve"
    viewBox={'0 0 1600 490'}
    style={{ width: '100%', height: 'auto' }}
  >
    <path
      fill="#47564C"
      stroke="#47564C"
      strokeMiterlimit={10}
      d="M1605.803 500H0V366.301s88.528-15.896 125.305-17.808c177.955-9.249 250.611 25.376 380.128 25.376 111.462 0 254.794-18.954 384.339-26.947 210.578-12.99 290.625 30.311 514.91 5.925 135.889-14.773 201.121 13.454 201.121 13.454V500z"
    />
    <g fill="#47564C" fillRule="evenodd" clipRule="evenodd">
      <path d="M872.766 348.516c-.899.047-1.5.103-2.097.103-11.802.008-23.889 2.126-35.689 2.199-1.715.011-1.912-2.672-1.859-4.341.112-3.661.122-7.33-.009-10.984-.067-1.898.42-2.681 2.466-2.564 2.974.172 5.966.046 8.95.044 2.626-.004 2.655-.007 2.656-2.717.012-10.235.004-20.468 0-30.704-.005-18.034-.013-36.066-.013-54.099 0-3.106.013-3.106-3.047-3.109-3.119-.001-6.242-.1-9.355.039-1.933.085-2.477-.662-2.417-2.487.11-3.388.117-6.786-.005-10.171-.061-1.664.572-2.523 2.107-2.92 9.432-2.43 18.773-5.298 28.308-7.222 17.903-3.609 36.099-4.91 54.332-5.257 7.512-.142 15.059.2 22.55.81a489.98 489.98 0 0 1 28.658 3.159c12.147 1.705 24.094 4.397 35.709 8.445 1.589.555 2.259 1.304 2.189 3.053-.141 3.521-.104 7.054-.013 10.578.039 1.543-.542 2.013-2.016 1.99-4.128-.063-8.258-.02-12.637-.02-.052.9-.135 1.682-.137 2.464-.006 28.482-.006 56.97-.002 85.452 0 2.706.017 2.713 2.643 2.717 3.656.002 7.996-.018 11.096 0 .324.002.241 1.172.242 1.692.019 4.065-.005 8.137.02 12.206.009 1.083-.129 1.774-1.52 1.771-12.41-.046-37.505.133-37.98.021 0-1.629-.177-3.569-.087-5.234.073-1.361-.476-1.809-1.774-1.727-1.283.08-60.425.036-88.706-.026-2.025-.003-2.529.315-2.596 2.579-.039 1.333.033 2.686.033 4.26zm32.397-97.117h-30.112c-.115 2.626.011 4.116-.055 6.259-.302-.014-1.614.193-1.915.181-.123-2.138-.043-4.284-.176-6.545-1.775 0-3.321.037-4.881-.027-1.777-.076-2.149.632-2.146 2.245.04 25.63.054 51.262-.011 76.893-.005 2.074.596 2.616 2.644 2.613 33.77-.063 67.54-.046 101.311-.046 2.819 0 2.823-.007 2.823-2.955v-76.084c0-.544.11-1.13-.061-1.615-.14-.4-.606-.954-.951-.971-2.005-.092-4.016-.046-6.134-.046 0 1.873.071 3.5-.043 5.111-.032.481-.577.925-.888 1.388-.269-.465-.76-.917-.772-1.397-.045-1.639-.002-3.385-.002-5.136-.775-.019-30.271-.069-30.271-.069s.113 2.428-.174 3.541c-.13.499-.618.903-.943 1.352-.309-.44-.825-.854-.886-1.326-.134-1.053-.047-2.287-.047-3.53-.988-.013-24.304.142-24.304.142s.061 2.406-.16 3.508c-.085.431-.571.779-.877 1.166-.324-.431-.862-.835-.923-1.3-.143-1.054-.046-2.134-.046-3.352zm-39.259-6.52c.012 3.915-.214 3.463 3.541 3.463 33.488.008 66.978.005 100.467.004.543 0 1.09.034 1.623-.036.309-.04.842-.242.852-.394.1-1.675.048-3.359.033-5.02-.006-.733-1.623-.527-2.497-.529-33.895-.026-67.79-.023-101.686-.023-2.961.071-2.219.002-2.333 2.535z" />
      <path d="M963.374 350.755h-3.35c-27.532 0-55.066-.02-82.597.046-2.062.007-2.581-.522-2.585-2.606-.01-4.205.063-4.169 4.226-4.169 27.33.004 54.658.029 81.986-.036 1.926-.004 2.528.563 2.344 2.396.033 1.43-.024 2.686-.024 4.369zM831.007 312.92v39.25c-4.236 0-8.352.006-12.468-.004-1.448-.003-1.094-1.136-1.097-1.927-.028-6.988-.021-13.973-.022-20.956 0-4.815.058-9.631-.022-14.442-.024-1.523.463-1.994 1.978-1.954 3.79.096 7.586.033 11.631.033zm-6.666 14.773c-2.603-.083-4.58 1.745-4.643 4.295-.068 2.713 1.754 4.746 4.365 4.875 2.468.118 4.747-2.007 4.828-4.501.087-2.556-1.891-4.582-4.55-4.669zm-.088 21.065c2.552.015 4.589-1.913 4.653-4.4.069-2.67-2.023-4.788-4.728-4.788-2.505 0-4.444 1.971-4.475 4.55-.032 2.672 1.884 4.625 4.55 4.638zm3.098-28.619c-.029-1.804-1.277-3.05-3.062-3.05-1.773-.002-3.251 1.438-3.253 3.174-.004 1.701 1.572 3.252 3.26 3.205 1.783-.046 3.088-1.467 3.055-3.329zM1007.353 309.528h13.334c.052.765.133 1.42.133 2.079.009 11.584-.036 23.172.048 34.755.014 1.908-.58 2.426-2.42 2.342-3.246-.146-6.503-.076-9.754-.029-1.132.017-1.566-.388-1.563-1.53.034-12.333.034-24.662.047-36.994.001-.13.07-.256.175-.623zm11.204 19.091c-.026-2.672-1.98-4.554-4.688-4.507-2.473.037-4.47 2.083-4.484 4.587-.015 2.493 2.218 4.731 4.659 4.673 2.589-.059 4.535-2.109 4.513-4.753zm-4.613 16.624c2.598.023 4.578-1.834 4.635-4.348.06-2.662-1.882-4.792-4.416-4.841-2.573-.051-4.728 1.983-4.784 4.517-.057 2.583 1.964 4.654 4.565 4.672zm-.024-25.27c1.676.06 3.271-1.49 3.302-3.205.027-1.735-1.442-3.199-3.232-3.219-1.791-.017-3.07 1.215-3.143 3.033-.072 1.766 1.346 3.327 3.073 3.391zM881.808 262.36c-1.144 1.146-2.497 2.695-3.853 4.051-4.158-3.641-7.455-7.129-5.345-9.22 1.001-1.012 1.106-1.614 2.521-1.825 2.325-.344 5.441 5.528 6.677 6.994z" />
      <path d="m884.243 262.501-6.237 6.065c-.714-1.006-.824-2.195.393-3.011 1.851-1.241 2.457-4.494 5.844-3.054zM908.798 263.799c-1.614.1-3.656.364-5.567.481-.702-5.483-.858-10.279 2.109-10.446 1.419-.094 1.898-.476 3.095.303 1.968 1.282.412 7.745.363 9.662z" />
      <path d="M910.528 265.52c-3.026.144-5.745.268-8.689.407.133-1.225.839-2.192 2.289-1.994 2.21.298 4.821-1.736 6.4 1.587zM934.359 265.039c-1.615.044-3.665.237-5.578.289-.514-5.506-.506-10.304 2.467-10.369 1.423-.047 1.914-.41 3.083.411 1.923 1.35.146 7.752.028 9.669z" />
      <path d="m935.842 264.991-8.698.108c.175-1.22.912-2.161 2.356-1.915 2.198.376 4.877-1.569 6.342 1.807zM962.185 263.838c-1.166-1.119-2.745-2.444-4.126-3.771 3.561-4.23 6.984-7.593 9.117-5.521 1.03.98 1.635 1.073 1.871 2.482.39 2.317-5.419 5.547-6.862 6.81z" />
      <path d="m962.092 266.277-6.185-6.119c.989-.731 2.179-.868 3.017.335 1.278 1.827 4.543 2.371 3.168 5.784z" />
    </g>
    <g fill="#47564C">
      <path d="M250.327 297.895c-14.447.964-38.603-6.326-38.603-6.326s-13.406 1.832-30.743-4.589l-29.536 86.361 147.039 8.347-48.157-83.793z" />
      <path
        stroke="#47564C"
        strokeMiterlimit={10}
        d="m250.051 298.924.089-8.014M256.03 293.877l-5.89 1.694v-4.661zM211.904 292.587l.09-8.015M217.884 287.539l-5.89 1.695v-4.662zM181.26 288.579l.09-8.014M187.239 283.532l-5.889 1.695v-4.662z"
      />
      <path d="M128.34 313.532c-9.043.604-24.163-3.96-24.163-3.96s-8.392 1.146-19.244-2.872l-18.488 54.058 92.039 5.225-30.144-52.451z" />
      <path
        stroke="#47564C"
        strokeMiterlimit={10}
        d="m128.167 314.177.056-5.017M131.91 311.018l-3.687 1.06v-2.918zM104.29 310.21l.056-5.017M108.033 307.051l-3.687 1.06v-2.918zM85.108 307.701l.056-5.015M88.851 304.542l-3.687 1.061v-2.917z"
      />
      <path d="M596.133 317.834c14.447.964 38.603-6.326 38.603-6.326s13.406 1.832 30.743-4.589l29.536 86.361-147.039 8.347 48.157-83.793z" />
      <path
        stroke="#47564C"
        strokeMiterlimit={10}
        d="m596.41 318.863-.09-8.013M590.431 313.816l5.889 1.695v-4.661zM634.556 312.526l-.09-8.014M628.577 307.479l5.889 1.695v-4.662zM665.201 308.519l-.09-8.014M659.221 303.472l5.89 1.694v-4.661z"
      />
      <path d="M1566.276 325.441c-10.117.675-27.032-4.431-27.032-4.431s-9.388 1.283-21.528-3.213l-20.684 60.477L1600 384.119l-33.724-58.678z" />
      <path
        stroke="#47564C"
        strokeMiterlimit={10}
        d="m1566.083 326.162.063-5.612M1570.27 322.628l-4.124 1.186v-3.264zM1539.37 321.725l.063-5.614M1543.558 318.189l-4.125 1.188v-3.266zM1517.911 318.918l.063-5.611M1522.098 315.384l-4.124 1.186v-3.263z"
      />
    </g>
    <g fill="#47564C">
      <path d="M427.523 373.047c.069 1.247-7.818 1.247-7.887 0-1.542-27.682-2.019-145.564 0-179.708.046-.793 2.825-1.313 2.84-.095.559 42.659 3.268 147.645 5.047 179.803z" />
      <path d="M426.971 311.424c-4.059.603-25.039 19.702-29.154 19.702-3.93 0-17.758-17.2-25.491-17.589-3.931-.198-37.682 11.638-50.473 10.195-3.73-.421-25.499-6.444-23.198-7.903 39.488-25.025 102.986-75.199 114.712-100.181l15.04 1.274c31.865 48.435 89.093 80.339 111.398 96.357.49.353-10.465 5.338-14.275 5.338-2.252 0-33.863-9.347-39.767-8.651-1.791.211-22.195 20.266-24.727 19.884-5.452-.822-31.006-18.878-34.065-18.426z" />
    </g>
    <g fill="#47564C">
      <path d="M1428.493 325.142c7.359 8.879-72.685-16.111-84.217-16.081-17.458.047-61.685 18.9-79.14 18.621-16.714-.269-79.427-17.268-96.066-15.66-8.951.865-83.783 23.251-79.705 15.236 12.272-24.121 54.244-98.641 91.133-160.816 4.282-7.22 59.774 35.125 80.087 33.009 12.236-1.275 68.032-39.763 71.419-33.838 30.036 52.557 50.889 104.514 96.489 159.529z" />
      <path d="M1197.841 360.964c.06 2.247-8.318 2.62-8.435.375-2.806-54.33-10.154-199.567-9.36-211.166.155-2.242 5.889-2.521 6.128-.285 4.298 40.314 10.097 152.124 11.667 211.076zM1318.221 367.653c-.046 2.276 8.335 2.708 8.438.433 2.479-55.027 8.952-202.138 8.088-213.896-.167-2.272-5.903-2.591-6.129-.327-4.055 40.819-9.18 154.069-10.397 213.79z" />
    </g>
  </svg>
);

export const FooterCopyrightArea: React.FC = async () => {
  const year = new Date().getFullYear();
  const copyright = `© ${year} · conveniat27`;

  const build = await getBuildInfo();
  const isInAppDesign = await renderInAppDesign();
  const locale = await getLocaleFromCookies();

  return (
    <>
      <div style={{ width: '100%' }}>
        <FooterGraphic />
      </div>
      <div
        className={cn(
          'flex',
          'w-full',
          'flex-col',
          'items-center',
          'justify-center',
          'bg-green-600',
          'text-green-200',
          'pb-6',
          { 'pb-16': isInAppDesign },
        )}
      >
        <FooterCopyrightText>{copyright}</FooterCopyrightText>
        <div className="mb-[20px]">
          <CeviSchweiz className="h-12 w-56" />
        </div>
        {
          /* The build info may not be available in (local) development mode */
          build !== undefined && (
            <div className="mb-[16px] flex flex-col text-center">
              <FooterMinimalMenu />
              <SocialMediaLinks />

              {!isInAppDesign && (
                <>
                  <FooterBuildInfoText>Version {build.version} </FooterBuildInfoText>
                  <FooterBuildInfoText>
                    Build {build.git.hash} {footerCopyrightText[locale]} {build.timestamp}
                  </FooterBuildInfoText>
                </>
              )}
            </div>
          )
        }
      </div>
    </>
  );
};
